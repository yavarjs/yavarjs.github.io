<!doctype html><html dir=rtl lang=fa><head><title>استقرار سریع و ساده اپلیکیشن NestJS روی Vercel | یاvar</title>
<meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="بر اساس راهنمای رسمی Vercel و روش به‌روز"><meta name=generator content="Hugo 0.139.2"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><meta name=author content="حمیدرضا مهدوی پناه"><meta name=keywords content="js,جاوااسکریپت,deployment,express,nestjs,node.js,vercel,typescript,vercel,nestjs,node.js,deployment"><link href=https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v28.0.0/dist/font-face.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://yavarjs.ir/css/custom.css><link rel="shortcut icon" href=/images/favicon.ico type=image/x-icon><script async src="https://www.googletagmanager.com/gtag/js?id=G-TB5X9PJPXB"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-TB5X9PJPXB")}</script></head><body><nav class=navigation><a href=/>خانه <span class=arrow>→</span></a>
<a href=/tags>برچسب‌ها</a>
<a href=/about>درباره یاvar</a></nav><main class=main><section id=single><h1 class=title>استقرار سریع و ساده اپلیکیشن NestJS روی Vercel</h1><div class=tip><span>حمیدرضا مهدوی پناه
</span><span class=split>·
</span><span>خواندن 3 دقیقه
</span><span class=split>·
</span><span>590 کلمه
</span><span class=split>·
</span><span>۱۴۰۳/۹/۷</span></div><aside class=toc><details><summary>فهرست</summary><div><nav id=TableOfContents><ul><li><a href=#پشتیبانی-vercel-از-express-apps>پشتیبانی Vercel از Express Apps</a></li><li><a href=#مرحله-۱---ساخت-یک-اپلیکیشن-nestjs>مرحله ۱ - ساخت یک اپلیکیشن NestJS</a></li><li><a href=#مرحله-۲---نصب-بستههای-npm-موردنیاز>مرحله ۲ - نصب بسته‌های NPM موردنیاز</a></li><li><a href=#مرحله-۳---ساخت-فایل-srcappfactoryts>مرحله ۳ - ساخت فایل <code>src/AppFactory.ts</code></a></li><li><a href=#مرحله-۴---ویرایش-فایل-srcmaints>مرحله ۴ - ویرایش فایل <code>src/main.ts</code></a></li><li><a href=#مرحله-۵---افزودن-فایل-apiindexts>مرحله ۵ - افزودن فایل <code>api/index.ts</code></a></li><li><a href=#مرحله-۶---افزودن-فایل-verceljson>مرحله ۶ - افزودن فایل <code>vercel.json</code></a></li><li><a href=#مرحله-۷---ایجاد-پروژه-روی-vercel>مرحله ۷ - ایجاد پروژه روی Vercel</a></li></ul></nav></div></details></aside><div class=content><p>بر اساس راهنمای رسمی Vercel و روش به‌روز</p><p>این راهنما برای کسانی که از <a href=https://expressjs.com/ target=_blank rel=noopener>Express</a> adapter استفاده می‌کنند مفید است. برای اپلیکیشن‌های NestJS که از <a href=https://fastify.dev/ target=_blank rel=noopener>Fastify</a> adapter استفاده می‌کنند، لینک‌های زیر ممکن است کمک‌کننده باشد:</p><ul><li><a href=https://fastify.dev/docs/latest/Guides/Serverless/#vercel target=_blank rel=noopener>Fastify Guide for Serverless on Vercel</a></li><li><a href=https://github.com/vercel/examples/tree/main/starter/fastify target=_blank rel=noopener>Fastify Examples on GitHub</a></li></ul><p>🚀 شما می‌توانید کد کامل مطرح‌شده در این مقاله را در این مخزن GitHub پیدا کنید: <a href=https://github.com/mahdavipanah/nestjs-on-vercel target=_blank rel=noopener>nestjs-on-vercel</a></p><h2 id=پشتیبانی-vercel-از-express-apps>پشتیبانی Vercel از Express Apps <a href=#%d9%be%d8%b4%d8%aa%db%8c%d8%a8%d8%a7%d9%86%db%8c-vercel-%d8%a7%d8%b2-express-apps class=anchor>🔗</a></h2><p>Vercel ویژگی مناسبی برای استقرار Express app ارائه می‌دهد که شامل مراحل زیر است:</p><ol><li>expose کردن شیء Express app در یک API.</li><li>تعریف یک rewrite rule که تمام ترافیک ورودی را به این API هدایت کند.</li></ol><p>من برای استقرار NestJS از <a href=https://vercel.com/guides/using-express-with-vercel target=_blank rel=noopener>راهنمای رسمی Vercel برای Express</a> استفاده کردم، به این صورت که شیء Express app زیربنایی NestJS را اکسپوز کردم.</p><h2 id=مرحله-۱---ساخت-یک-اپلیکیشن-nestjs>مرحله ۱ - ساخت یک اپلیکیشن NestJS <a href=#%d9%85%d8%b1%d8%ad%d9%84%d9%87-%db%b1---%d8%b3%d8%a7%d8%ae%d8%aa-%db%8c%da%a9-%d8%a7%d9%be%d9%84%db%8c%da%a9%db%8c%d8%b4%d9%86-nestjs class=anchor>🔗</a></h2><p>اگر قبلاً یک اپ NestJS دارید، می‌توانید این مرحله را رد کنید.</p><p><a href=https://docs.nestjs.com/first-steps target=_blank rel=noopener>نصب NestJS</a> و ایجاد اپ جدید:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a></span><span>nest new my-app
</span></span></code></pre></div><h2 id=مرحله-۲---نصب-بستههای-npm-موردنیاز>مرحله ۲ - نصب بسته‌های NPM موردنیاز <a href=#%d9%85%d8%b1%d8%ad%d9%84%d9%87-%db%b2---%d9%86%d8%b5%d8%a8-%d8%a8%d8%b3%d8%aa%d9%87%d9%87%d8%a7%db%8c-npm-%d9%85%d9%88%d8%b1%d8%af%d9%86%db%8c%d8%a7%d8%b2 class=anchor>🔗</a></h2><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a></span><span>npm install express @nestjs/platform-express
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2>2</a></span><span>npm install -D @types/express
</span></span></code></pre></div><h2 id=مرحله-۳---ساخت-فایل-srcappfactoryts>مرحله ۳ - ساخت فایل <code>src/AppFactory.ts</code> <a href=#%d9%85%d8%b1%d8%ad%d9%84%d9%87-%db%b3---%d8%b3%d8%a7%d8%ae%d8%aa-%d9%81%d8%a7%db%8c%d9%84-srcappfactoryts class=anchor>🔗</a></h2><p>این فایل به‌عنوان یک ماژول واحد عمل می‌کند که تمامی پیکربندی‌های ضروری اپلیکیشن NestJS را مدیریت کرده و هم NestJS app و هم شیء Express app زیربنایی آن را اکسپورت می‌کند.</p><p>ساخت فایل <code>AppFactory.ts</code> در پوشه <code>src</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1> 1</a></span><span><span style=color:#000;font-weight:700>import</span> { ExpressAdapter } <span style=color:#000;font-weight:700>from</span> <span style=color:#d14>&#34;@nestjs/platform-express&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2> 2</a></span><span><span style=color:#000;font-weight:700>import</span> { NestFactory } <span style=color:#000;font-weight:700>from</span> <span style=color:#d14>&#34;@nestjs/core&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3> 3</a></span><span><span style=color:#000;font-weight:700>import</span> express, { Request, Response } <span style=color:#000;font-weight:700>from</span> <span style=color:#d14>&#34;express&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-4> 4</a></span><span><span style=color:#000;font-weight:700>import</span> { Express } <span style=color:#000;font-weight:700>from</span> <span style=color:#d14>&#34;express&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-5> 5</a></span><span><span style=color:#000;font-weight:700>import</span> { INestApplication } <span style=color:#000;font-weight:700>from</span> <span style=color:#d14>&#34;@nestjs/common&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-6> 6</a></span><span><span style=color:#000;font-weight:700>import</span> { AppModule } <span style=color:#000;font-weight:700>from</span> <span style=color:#d14>&#34;./app.module.js&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-7> 7</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-8> 8</a></span><span><span style=color:#000;font-weight:700>export</span> <span style=color:#000;font-weight:700>class</span> AppFactory {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-9> 9</a></span><span>  <span style=color:#000;font-weight:700>static</span> create()<span style=color:#000;font-weight:700>:</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-10>10</a></span><span>    appPromise: <span style=color:#458;font-weight:700>Promise</span>&lt;<span style=color:navy>INestApplication</span><span style=color:#a61717;background-color:#e3d2d2>&lt;</span><span style=color:teal>any</span>&gt;<span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-11>11</a></span><span>    expressApp: <span style=color:#458;font-weight:700>Express</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-12>12</a></span><span>  } {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-13>13</a></span><span>    <span style=color:#000;font-weight:700>const</span> expressApp <span style=color:#000;font-weight:700>=</span> express()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-14>14</a></span><span>    <span style=color:#000;font-weight:700>const</span> adapter <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>new</span> ExpressAdapter(expressApp)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-15>15</a></span><span>    <span style=color:#000;font-weight:700>const</span> appPromise <span style=color:#000;font-weight:700>=</span> NestFactory.create(AppModule, adapter)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-16>16</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-17>17</a></span><span>    appPromise
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-18>18</a></span><span>      .then((app) <span style=color:#000;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-19>19</a></span><span>        app.enableCors({
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-20>20</a></span><span>          exposedHeaders<span style=color:#000;font-weight:700>:</span> <span style=color:#d14>&#34;*&#34;</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-21><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-21>21</a></span><span>        })
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-22><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-22>22</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-23><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-23>23</a></span><span>        app.init()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-24><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-24>24</a></span><span>      })
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-25><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-25>25</a></span><span>      .<span style=color:#000;font-weight:700>catch</span>((err) <span style=color:#000;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-26><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-26>26</a></span><span>        <span style=color:#000;font-weight:700>throw</span> err
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-27><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-27>27</a></span><span>      })
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-28><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-28>28</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-29><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-29>29</a></span><span>    expressApp.use((req: <span style=color:#458;font-weight:700>Request</span>, res: <span style=color:#458;font-weight:700>Response</span>, next) <span style=color:#000;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-30><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-30>30</a></span><span>      appPromise
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-31><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-31>31</a></span><span>        .then(<span style=color:#000;font-weight:700>async</span> (app) <span style=color:#000;font-weight:700>=&gt;</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-32><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-32>32</a></span><span>          <span style=color:#000;font-weight:700>await</span> app.init()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-33><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-33>33</a></span><span>          next()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-34><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-34>34</a></span><span>        })
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-35><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-35>35</a></span><span>        .<span style=color:#000;font-weight:700>catch</span>((err) <span style=color:#000;font-weight:700>=&gt;</span> next(err))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-36><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-36>36</a></span><span>    })
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-37><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-37>37</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-38><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-38>38</a></span><span>    <span style=color:#000;font-weight:700>return</span> { appPromise, expressApp }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-39><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-39>39</a></span><span>  }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-40><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-40>40</a></span><span>}
</span></span></code></pre></div><h2 id=مرحله-۴---ویرایش-فایل-srcmaints>مرحله ۴ - ویرایش فایل <code>src/main.ts</code> <a href=#%d9%85%d8%b1%d8%ad%d9%84%d9%87-%db%b4---%d9%88%db%8c%d8%b1%d8%a7%db%8c%d8%b4-%d9%81%d8%a7%db%8c%d9%84-srcmaints class=anchor>🔗</a></h2><p>به‌طور پیش‌فرض، فایل <code>src/main.ts</code> نقطه ورودی اپلیکیشن است. این فایل را تغییر دهید تا تنها متد <code>listen</code> را فراخوانی کند:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>1</a></span><span><span style=color:#000;font-weight:700>import</span> { AppFactory } <span style=color:#000;font-weight:700>from</span> <span style=color:#d14>&#34;./AppFactory.js&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2>2</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3>3</a></span><span><span style=color:#000;font-weight:700>async</span> <span style=color:#000;font-weight:700>function</span> bootstrap() {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-4>4</a></span><span>  <span style=color:#000;font-weight:700>const</span> { appPromise } <span style=color:#000;font-weight:700>=</span> AppFactory.create()
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-5>5</a></span><span>  <span style=color:#000;font-weight:700>const</span> app <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>await</span> appPromise
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-6>6</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-7>7</a></span><span>  <span style=color:#000;font-weight:700>await</span> app.listen(process.env.PORT <span style=color:#000;font-weight:700>??</span> <span style=color:#099>3000</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-8>8</a></span><span>}
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-9>9</a></span><span>bootstrap()
</span></span></code></pre></div><h2 id=مرحله-۵---افزودن-فایل-apiindexts>مرحله ۵ - افزودن فایل <code>api/index.ts</code> <a href=#%d9%85%d8%b1%d8%ad%d9%84%d9%87-%db%b5---%d8%a7%d9%81%d8%b2%d9%88%d8%af%d9%86-%d9%81%d8%a7%db%8c%d9%84-apiindexts class=anchor>🔗</a></h2><p><a href=https://vercel.com/docs/functions/runtimes/node-js target=_blank rel=noopener>Vercel</a> به‌طور پیش‌فرض هر فانکشنی که در پوشه <code>api</code> قرار دارد را اجرا می‌کند. بنابراین، یک فایل در این پوشه ایجاد کنید که شیء Express app را اکسپورت کند:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a></span><span><span style=color:#998;font-style:italic>/**
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-2>2</a></span><span><span style=color:#998;font-style:italic> * This file exports Express instance for specifically for the deployment of the app on Vercel.
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-3>3</a></span><span><span style=color:#998;font-style:italic> */</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-4>4</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-5>5</a></span><span><span style=color:#000;font-weight:700>import</span> { AppFactory } <span style=color:#000;font-weight:700>from</span> <span style=color:#d14>&#34;../src/AppFactory.js&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-6>6</a></span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-7>7</a></span><span><span style=color:#000;font-weight:700>export</span> <span style=color:#000;font-weight:700>default</span> AppFactory.create().expressApp
</span></span></code></pre></div><h2 id=مرحله-۶---افزودن-فایل-verceljson>مرحله ۶ - افزودن فایل <code>vercel.json</code> <a href=#%d9%85%d8%b1%d8%ad%d9%84%d9%87-%db%b6---%d8%a7%d9%81%d8%b2%d9%88%d8%af%d9%86-%d9%81%d8%a7%db%8c%d9%84-verceljson class=anchor>🔗</a></h2><p>در دایرکتوری روت پروژه یک فایل <code>vercel.json</code> ایجاد کنید تا Vercel را پیکربندی کنید:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1> 1</a></span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-2> 2</a></span><span>  <span style=color:navy>&#34;version&#34;</span>: <span style=color:#099>2</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-3> 3</a></span><span>  <span style=color:navy>&#34;buildCommand&#34;</span>: <span style=color:#d14>&#34;npm run build&#34;</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-4> 4</a></span><span>  <span style=color:navy>&#34;outputDirectory&#34;</span>: <span style=color:#d14>&#34;.&#34;</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-5> 5</a></span><span>  <span style=color:navy>&#34;rewrites&#34;</span>: [
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-6> 6</a></span><span>    {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-7> 7</a></span><span>      <span style=color:navy>&#34;source&#34;</span>: <span style=color:#d14>&#34;/(.*)&#34;</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-8> 8</a></span><span>      <span style=color:navy>&#34;destination&#34;</span>: <span style=color:#d14>&#34;/api&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-9> 9</a></span><span>    }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-10>10</a></span><span>  ]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-11>11</a></span><span>}
</span></span></code></pre></div><h2 id=مرحله-۷---ایجاد-پروژه-روی-vercel>مرحله ۷ - ایجاد پروژه روی Vercel <a href=#%d9%85%d8%b1%d8%ad%d9%84%d9%87-%db%b7---%d8%a7%db%8c%d8%ac%d8%a7%d8%af-%d9%be%d8%b1%d9%88%da%98%d9%87-%d8%b1%d9%88%db%8c-vercel class=anchor>🔗</a></h2><p>تبریک 🎉! تقریباً تمام شد. حالا یک مخزن Git ایجاد کنید و کدتان را در آن push کنید. سپس وارد حساب Vercel خود شوید، یک پروژه جدید ایجاد کنید و مخزن Git را ایمپورت کنید. <a href=https://github.com/mahdavipanah/nestjs-on-vercel target=_blank rel=noopener>همچنین می‌توانید از مخزن GitHub مثال این مقاله استفاده کنید.</a></p><p><p class=markdown-image><img src=https://cdn.hashnode.com/res/hashnode/image/upload/v1732642786627/ff53c571-d062-486f-9ba0-db195dfb7b93.png alt></p></p><hr><p>منبع:
<a href=https://hamidreza.tech/nestjs-on-vercel target=_blank rel=noopener>Fast and Simple NestJS App Deployment on Vercel</a>
از وبلاگ Software Alchemist</p></div><div class=tags><a href=https://yavarjs.ir/tags/vercel>vercel</a>
<a href=https://yavarjs.ir/tags/nestjs>nestjs</a>
<a href=https://yavarjs.ir/tags/node.js>node.js</a>
<a href=https://yavarjs.ir/tags/deployment>deployment</a></div><script src=https://utteranc.es/client.js repo=yavarjs/utterances-comments issue-term=pathname theme=github-light crossorigin=anonymous async></script></section></main><footer id=footer><div class=copyright>مطالب با اشاره به یاvar به عنوان منبع قابل انتشارن.</p><p class=powerby>قدرت‌گرفته از <a href=http://www.gohugo.io/>Hugo</a> با تم <a href=https://github.com/yavarjs/hugo-theme-mini>mini</a></p></footer></body></html>